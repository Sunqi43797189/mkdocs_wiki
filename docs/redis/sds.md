### 使用C语言原生字符串不足
- 以"\0"来判断结尾，导致字符串中不能出现"\0"，不利于存储任意二进制数据
- 操作函数复杂度太高，取长度也需要O(n)时间复杂度，不利于快速的redis进行操作

### SDS
- Simple Dynamic String
- 一个字符数组`buf[]`，用来保存实际的数据
- 数组现有长度`len`
-  分配给字符数组的空间长度`alloc`
- SDS 类型 `flags`
- 内存预分配：SDS 扩容，会多申请一些内存（小于 1MB 翻倍扩容，大于 1MB 按 1MB 扩容）
- 多余内存不释放：SDS 缩容，不释放多余的内存，下次使用可直接复用这些内存

```c

struct __attribute__ ((__packed__)) sdshdr8 {
    uint8_t len; /* 字符数组现有长度*/
    uint8_t alloc; /* 字符数组的已分配空间，不包括结构体和\0结束字符*/
    unsigned char flags; /* SDS类型*/
    char buf[]; /*字符数组*/
};
```
### 优势
- 降低了字符串长度的复杂度
- 单独计算了字符串长度，二进制安全，不用判断"\0"
- 避免了对字符串的遍历操作，创建，追加，复制和比较等功能更加高效
- 紧凑型字符串结构更加节省内存

### 紧凑型字符串结构
- SDS中的len个alloc类型是可变的
- 分别是uint8，uint16，uint32，uint64
- 分别占用1字节，2字节，4字节，8字节
- 能表示的字符串长度分别为2的8次方，16次方，32次方，64次方
- 能灵活保存不同大小的字符串，有效节省内存空间
- 使用 `__attribute__ ((__packed__))`定义结构体，编译器会按照实际结构体大小进行内存分配

